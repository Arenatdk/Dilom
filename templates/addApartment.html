{% extends "base.html" %}
{% load static %}



{% block content %}
    <h1>{{ pk }}</h1>
    <div class="box">
        <div class="box-header with-border">
            <h3 class="box-title">Начисления</h3>
            <div class="box-tools pull-right">
                <!-- Buttons, labels, and many other things can be placed here! -->
                <!-- Here is a label for example -->
                <span class="label label-primary">Label</span>
            </div><!-- /.box-tools -->
        </div><!-- /.box-header -->
        <div class="box-body">
            <table class="table table-bordered nth-2-center">
                <tbody>
                <tr>

                    <th>Название</th>
                    <th>Тип</th>
                    <th>Коментарий</th>
                    <th style="width: 40px">Включен</th>
                </tr>
                {% for tarif in tariff %}
                    <tr>


                        <td>{{ tarif.name }}</td>
                        <td>{{ tarif.type.type_name }}</td>
                        <td>{{ tarif.coment }}</td>
                        <td><input type="checkbox" onclick="f(this,{{ pk }},{{ tarif.id }})"
                                   {% if tarif in CurTarrif %}checked{% endif %}></td>
                        </td>


                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div><!-- /.box-body -->
        <div class="box-footer">
            The footer of the box
        </div><!-- box-footer -->
    </div><!-- /.box -->

    <div class="box">
        <div class="box-header with-border">
            <h3 class="box-title">Данные о квартире</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-block btn-primary btn-xs" data-toggle="modal"
                        data-target="#editCount" data-whatever="@mdo">Редактировать
                </button>
            </div><!-- /.box-tools -->
        </div><!-- /.box-header -->
        <div class="box-body">

            <div class="row">
                <div class="col-md-3">Количество проживающих:<h3> {{ Apart.countResidents }} чл.</h3></div>
                <div class="col-md-3">Количество комнат:<h3> {{ Apart.countRooms }}</h3></div>
                <div class="col-md-3">Общая площадь:<h3> {{ Apart.area }} м²</h3></div>
                <div class="col-md-3">Отопительная площадь:<h3> {{ Apart.HotArea }} м²</h3></div>
            </div>
        {% if Apart.subsidyi %}
            <div class="row">
                <div class="col-md-4"></div>
                <div class="col-md-4"><font color="red"><h3>Льготы: ({{ Apart.subsidyi.percent }}%) {{ Apart.subsidyi.name }}</h3></font></div>
                <div class="col-md-4"></div>
            </div>
        {% endif %}
            {% if Apart.isRent %}
            <div class="row">
                <div class="col-md-4"></div>
                <div class="col-md-4"><font color="red"><h3>Помещение сдается в аренду</h3></font></div>
                <div class="col-md-4"></div>
            </div>
            {% endif %}

        </div><!-- /.box-body -->
        <div class="box-footer">
            The footer of the box
        </div><!-- box-footer -->
    </div><!-- /.box -->



    <div class="box">
        <div class="box-header with-border">
            <h3 class="box-title">Данные о владельце</h3>
            <div class="box-tools pull-right">

            </div><!-- /.box-tools -->
        </div><!-- /.box-header -->
        <div class="box-body">


            {% if owner == '' %}
                <div class="row">
                    <div class="col-md-4"></div>
                    <div class="col-md-4">
                        <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
                            <i
                                    class="fa fa-plus"></i> Добавить владельца
                        </button>
                    </div>
                    <div class="col-md-4"></div>
                </div>
            {% else %}
                <div class="row">
                    <div class="col-md-3">Фамилия:<h3> {{ owner.LastName }}</h3></div>
                    <div class="col-md-3">Имя:<h3> {{ owner.FirstName }}</h3></div>
                    <div class="col-md-3">Отчество:<h3> {{ owner.patronymic }}</h3></div>
                    <div class="col-md-3">Номер телефона:<h3> {{ owner.number }}</h3></div>

                </div>
            {% endif %}

        </div><!-- /.box-body -->
        <div class="box-footer">
            The footer of the box
        </div><!-- box-footer -->
    </div><!-- /.box -->


    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Modal title</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" action="{% url 'apartamentAddUser' %}" method="post">
                        {% csrf_token %}
                        <div class="form-group">
                            <input type="hidden" value="{{ pk }}" name="apartID">
                            <label for="{{ addUserApartment.number.id_for_label }}"
                                   class="col-sm-2 control-label">Номер</label>
                            <div class="col-sm-10">
                                {{ addUserApartment.number }}
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="{{ addUserApartment.FirstName.id_for_label }}" class="col-sm-2 control-label">Имя</label>
                            <div class="col-sm-10">
                                {{ addUserApartment.FirstName }}
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="{{ addUserApartment.LastName.id_for_label }}" class="col-sm-2 control-label">Фамилия</label>
                            <div class="col-sm-10">
                                {{ addUserApartment.LastName }}
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="{{ addUserApartment.patronymic.id_for_label }}" class="col-sm-2 control-label">Отчество</label>
                            <div class="col-sm-10">
                                {{ addUserApartment.patronymic }}
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="{{ addUserApartment.countRes.id_for_label }}" class="col-sm-2 control-label">Количество
                                проживающих</label>
                            <div class="col-sm-10">
                                {{ addUserApartment.countRes }}
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="submit" class="btn btn-default">Сохранить</button>
                            </div>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="editCount" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="exampleModalLabel">New message</h4>
                </div>
                <form action="/apartment/{{ pk }}/edit/" method="post">
                    {% csrf_token %}
                    {{ ea.Apartment }}
                <div class="modal-body">
                    <div class="form-group">
                        <label for="exampleInputEmail1">Количество проживающих</label>
                        {{ ea.countRes }}
                    </div>

                    <div class="form-group">
                        <label for="exampleInputEmail1">Количество комнат</label>
                        {{ ea.countRooms }}
                    </div>

                    <div class="form-group">
                        <label for="exampleInputEmail1">Общая площадь</label>
                        {{ ea.area }}
                    </div>

                    <div class="form-group">
                        <label for="exampleInputEmail1">Отопительная площадь</label>
                        {{ ea.HotArea }}
                    </div>



                <div class="form-group">
                        <label for="exampleInputEmail1">Льготы</label>
                        <select id="subs" onchange="GetPattrn()" class="form-control" name="subs">
                        <option value="0"></option>
                            {% for p in subs %}
                                <option {% if Apart.subsidyi.id == p.id %} selected{% endif %} value="{{ p.id }}">{{ p.name }}</option>
                            {% endfor %}
                        </select>
                    </div>



                    <div class="form-group">
                        <label for="exampleInputEmail1">Сдается в аренду </label>
                        {{ ea.isRent }}
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
                    </form>
            </div>
        </div>
    </div>

    <script src="{% static 'plugins/jQuery/jquery-2.2.3.min.js' %}"></script>
    <!-- Bootstrap 3.3.6 -->
    <script src="{% static 'dist/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'jquery.maskedinput.min.js' %}"></script>
    <!-- iCheck -->
    <script type="text/javascript">
        jQuery(function ($) {
            $("#id_number").mask("+38 (999) 999-99-99");
        });

        function f(ChkB, pk, idTarrif) {

            $.get("/enableTarif", {pk: pk, idTarrif: idTarrif, enable: $(ChkB).prop('checked')})
                .done(function (data) {
                    if (data != 'none') {

                    }
                });
        }
    </script>
{% endblock %}